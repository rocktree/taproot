<aside id="sidebar">
  <div id="new-button-container" class="dropdown">
    <%= link_to 'NEW', '#', :id => 'new-button',
                :class => 'new button-color-2 dropdown-trigger' %>
    <ul>
      <% all_templates.each do |t| %>
        <li>
          <%= link_to t.title,
                      new_site_editor_page_path(current_site, :t => t.name),
                      :class => 'tk-modal-trigger',
                      :data => {
                        :modal_url => new_site_editor_page_path(
                          current_site, :t => t.name
                        )
                      } %>
        </li>
      <% end %>
    </ul>
  </div>
  <nav>
    <ul>
      <li class="<%= 'active' if controller_name == 'pages' && params[:status] != 'draft' %>">
        <%= link_to 'Pages', site_editor_pages_path(current_site),
                    :class => 'pages' %>
        <ul>
          <% all_pages_tree.each do |node| %>
            <% page = page_from_tree_node(node) %>
            <li>
              <%= link_to page.title,
                          site_editor_page_path(current_site, page) %>
              <% if node['children'].size > 0 %>
                <ul>
                  <% node['children'].each do |node| %>
                    <% page = page_from_tree_node(node) %>
                      <li>
                        <%= link_to page.title,
                                    site_editor_page_path(current_site, page) %>
                        <% if node['children'].size > 0 %>
                          <ul>
                            <% node['children'].each do |node| %>
                              <% page = page_from_tree_node(node) %>
                                <li>
                                  <%= link_to page.title,
                                              site_editor_page_path(current_site, page) %>
                                </li>
                            <% end %>
                          </ul>
                        <% end %>
                      </li>
                  <% end %>
                </ul>
              <% end %>
            </li>
          <% end %>
        </ul>
      </li>
      <li class="<%= 'active' if params[:status] == 'draft' %>">
        <%= link_to 'Drafts', site_editor_pages_path(current_site, :status => 'draft'),
                    :class => 'drafts' %>
      </li>
    </ul>
  </nav>
</aside>
